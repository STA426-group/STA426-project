---
title: "DMRs: BSseq"
author: "Hana Parizkova & Deepak Tanwar"
date: "<b>Created on:</b> 2018-11-25 <br> <b>Updated on:</b> `r Sys.Date()`"
output:
  html_document:
    theme: spacelab
    highlight: pyg
    keep_md: no
    number_sections: yes
    fig_width: 8.5
    fig_height: 11
    fig_caption: true
    df_print: paged
    code_folding: show
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
  fontsize: 12pt
  geometry: margin=1in
  documentclass: article
---

# Packages required
```{r, warning=F, message=FALSE}
library(dmrseq)
```


# BSseq objects

## Negative control
```{r}
load("./input/bsseq_neg_control.RData")
```

## Simulated data
```{r}
load("./input/bsseq_sim_100.RData")
```


# DMR files

## NC
```{r}
files.nc <- list.files(path = "./input", pattern = "neg_control.txt", full.names = T)
files.nc <- files.nc[grep(pattern = "anno", x = files.nc, invert = T)]
names(files.nc) <- sapply(files.nc, function(x) strsplit(x, "\\.|/")[[1]][4])

read.nc <- lapply(files.nc, function(x) GRanges(read.delim(x, sep = "\t", stringsAsFactors = F, header = T)))

# for(i in 1:length(read.nc)){
#   if(names(read.nc)[i] != "DMRcaller_dmr_bins_neg_control" | names(read.nc)[i] != "methpipe_dmr_neg_control"){
#     colnames(read.nc[[i]])[colnames(read.nc[[i]])]
#   }
# }

```


## SD
```{r}
anno.sim <- read.table("./input/anno_sim_data.txt.gz", sep = "\t", header = T, stringsAsFactors = F)
files.sim <- list.files(path = "./input", pattern = "sim_data.txt", full.names = T)
files.sim <- files.sim[grep(pattern = "anno", x = files.sim, invert = T)]

names(files.sim) <- sapply(files.sim, function(x) strsplit(x, "\\.|/")[[1]][4])

read.sim <- lapply(files.sim, function(x) GRanges(read.delim(x, sep = "\t", stringsAsFactors = F, header = T)))

pData(bs.sim$bs) <- anno.sim
```



# Annotation Human Genome
```{r}
anno <- getAnnot("hg19")
```


# Regions plot

## Simulated data

```{r}
plotDMRs(BSseq = bs.sim$bs, regions=bs.sim$gr.dmrs[1:10,], testCovariate="Group",
    compareTrack = GenomicRangesList(read.sim[c(6:9)]), qval = F, stat = F)
```


# SessionInfo

```{r}
devtools::session_info()
```